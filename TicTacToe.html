<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Tic Tac Toe</title>
    <link rel="stylesheet" href="./css/ttt.css" />
</head>

<body>
    <main class="panel">

        <!-- ðŸ”¹ Title -->
        <h1 class="title">Tic Tac Toe</h1>

        <!-- ðŸ”¹ Player Name -->
        <div class="player-info">
            Player: <span id="player-name">Loading...</span>
        </div>

        <!-- ðŸ”¹ Game Board -->
        <div class="board-wrapper">
            <!-- Overlay for "Waiting..." or "Start Game" -->
            <div id="board-overlay" class="overlay">
                <p id="overlay-text">Waiting for opponent...</p>
                <!--<button id="start-game-btn" class="hidden">Start Game</button>-->
            </div>

            <div id="game-board" class="game-board">
                <!-- 3x3 Grid: cells injected via JavaScript -->
            </div>
            <!--</div>-->

            <!-- ðŸ”¹ Piece Inventory -->
            <div class="inventory">
                <div class="piece-row">
                    <div class="piece-slot" data-size="small">
                        <div id="inventory-overlay-small" class="overlay hidden"></div>
                        <img class="small" src="images/TTT_Red.png" alt="Small Piece" data-size="small"
                            draggable="false" />
                        <div class="count" id="count-small">4</div>
                    </div>
                    <div class="piece-slot" data-size="medium">
                        <div id="inventory-overlay-medium" class="overlay hidden"></div>
                        <img class="medium" src="images/TTT_Red.png" alt="Medium Piece" data-size="medium"
                            draggable="false" />
                        <div class="count" id="count-medium">3</div>
                    </div>
                    <div class="piece-slot" data-size="large">
                        <div id="inventory-overlay-large" class="overlay hidden"></div>
                        <img class="large" src="images/TTT_Red.png" alt="Large Piece" data-size="large"
                            draggable="false" s />
                        <div class="count" id="count-large">2</div>
                    </div>
                </div>
            </div>
        </div>

    </main>

    <script type="module">
        //import { getUserData } from './js/core/db.js';
        //import { changeDisplayName, renderBoard } from './js/pages/ttt.js';
        //import { InventoryDragSetup } from './js/pages/ttt/inventory-drag.js';
        //import { BoardHoverSetup, SetCurrentDragPiece, ClearCurrentDragPiece, renderBoardFromState } from './js/pages/ttt/board.js';
        //import { loadBoardState, updateGame } from './js/pages/ttt/game-logic.js';
        //import { subscribeToGameUpdates } from './js/pages/ttt/game-subscribe.js';
        import { getSessionData, getGameId } from './js/pages/TicTacToe/session-data.js';
        import { subscribeToGameUpdates, getGameData } from './js/pages/TicTacToe/game-subscribe.js';
        import { changeDisplayName } from './js/pages/TicTacToe/ui.js';
        import { buildBoard, BoardHoverSetup, SetCurrentDragPiece, ClearCurrentDragPiece } from './js/pages/TicTacToe/board.js';
        import { renderInventoryToScreen } from './js/pages/TicTacToe/inventory.js';
        import { DragNDropSetup } from './js/pages/TicTacToe/drag-n-drop.js';

        document.addEventListener('DOMContentLoaded', () => {
            getSessionData();
            changeDisplayName('player-name');

            buildBoard();
            //BoardHoverSetup();

            renderInventoryToScreen();

            DragNDropSetup(SetCurrentDragPiece, ClearCurrentDragPiece);

            subscribeToGameUpdates(getGameId());

            getGameData(getGameId());
            //const user_data = getUserData();
            //console.log('Landing page loaded for user:', user_data.uuid);

            //changeDisplayName('player-name', user_data);

            //renderBoard();
            //BoardHoverSetup();
            //InventoryDragSetup(SetCurrentDragPiece, ClearCurrentDragPiece);

            //subscribeToGameUpdates(user_data.game_id, updateGame);

            //if (user_data.game_id) {
            //    loadBoardState(user_data.game_id, user_data.player, renderBoardFromState)
            //}
        });
    </script>
</body>

</html>